afxbkmk
あふのぶっくまーく

* あふのぶっくまーくとは

あふの &CD と &MENU の内部コマンドを利用して, フォルダ移動のみのあふの
登録フォルダみたいなことをする試みです. メニューファイルのテンプレート
とそれを書き換えるプログラムから成っています.

あふの登録フォルダとは独立しているので, 両方を併用することもできます. 
コピーや移動の送り先としても使う所は登録フォルダ, それ以外の単なる飛び
先はこれといった具合に使い分けることができます.


* インストール

あふと同じフォルダに afxbkmk.exe と afxbkmk.mnu を置いて,
&MENU "$V"afx"\afxbkmk.mnu"
のコマンドをどこかにキー定義してください.


* 使い方

上記のコマンドを呼び出すと "add/delete" という項目がでてきます. これを
選択するとカレントフォルダを登録します. 既に同じフォルダを登録してある
と登録を削除します.

色々と登録してあると上記の項目に並んで, 以前に登録したフォルダ名が表示
されます. それらを選択するとそのフォルダへ移動します.


* さらに使うために

afxbkmk.exe はいくつかの引数を受け取ります.

ハイフン "-" から始まる引数はオプションとして解釈します. 以下のオプシ
ョンがあります.

-d     追加しない. 既に登録してある同じフォルダを削除するのみ.
-m     削除しない. 既に登録してある同じフォルダは引数の指定に沿って
       再登録されます.
-M     削除しない. 既に登録してある同じフォルダの行はそのまま
       再登録されます.
-1〜9  引数でラベルを指定しないときにラベルとして使用するフォルダの
       階層を制限する. 登録するパスの末尾から数字の数だけのフォルダ
       が使われます.
-n     ラベルの先頭に0から始まる数字(0〜9)をつける.
-N     ラベルの先頭に1から始まる数字(1〜9)をつける.
-a     ラベルの先頭にaから始まるアルファベット(a〜z)をつける.
-A     ラベルの先頭にAから始まるアルファベット(A〜Z)をつける.
-l     引数からラベルを指定した時も登録するフォルダ名をラベルにつける.
       フォルダ名は指定したラベルの後につきます.
-L     引数からラベルを指定した時に -n -N -a -A によって
       編集されるのを防ぐ.
-e     &CDではなく&EXECにして登録する。

-d -m -M と -1〜9 はそれぞれ最後に指定したものが効果を持ちます.

-n, -N, -a, -A は既にあるラベルの数字とアルファベットを更新します. 数
字やアルファベットの数を超えると循環してはじめに戻ります. 複数指定する
と現れた順番に使います. 指定されていない種類のラベルやラベルのついてい
ない項目はそのままです.

オプションは複数まとめて -m3na のように書くことができます.

オプション以外の引数は
      1つめ メニューファイルの名前
      2つめ 登録するフォルダ名
  3つめ以降 ラベル
になります.


* 既知の不具合

- メニューファイルをきちんと解釈していないので,
  内容によっては誤動作します.
- 文字コード(特にUnicode)について考慮していません.
- あまりテストしていません.
- 一度全て読みこむので大きなファイルには使えません.

おかしなことになった時は直接 afxbkmk.mnu を編集してなんとかしてくださ
い.


* 使用条件

パブリックドメインソフトウェアです. このソフトウェアの原著作者は, この
ソフトウェアに関する一切の権利を放棄します. 同時にこのソフトウェアの引
き起こす事項について, 原著作者はいかなる責任も負わないものとします.

2011.05.14 yuratomo 追記
yuratomoはこのフトウェアの修正箇所に関する一切の権利を放棄します.
同時にこのソフトウェアの引き起こす事項について, いかなる責任も
負わないものとします.


* 更新履歴
2011年05月14日 by yuratomo
- -e オプション追加.
- Visual Studio 9でビルドできるように修正.
2007年12月19日
- -1〜9 オプションで正しくない結果になることがあったのを修正.
2007年12月16日
- 先頭に追加するように変更.
- std::vector を std::list に変更.
- オプションを色々と追加.
2004年10月12日
- 配布物に afxbkmk.mnu を入れ忘れていたので追加.
2004年9月28日
- なんとなく書いてみる.
